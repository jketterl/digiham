#include "golay_20_8.h"

/* generator matrix according to ETSI B.3.1
1 0 0 0 0 0 0 0 0 0 1 1 1 1 0 1 1 0 1 0
0 1 0 0 0 0 0 0 1 1 0 1 1 0 0 1 1 0 0 1
0 0 1 0 0 0 0 0 0 1 1 0 1 1 0 0 1 1 0 1
0 0 0 1 0 0 0 0 0 0 1 1 0 1 1 0 0 1 1 1
0 0 0 0 1 0 0 0 1 1 0 1 1 1 0 0 0 1 1 0
0 0 0 0 0 1 0 0 1 0 1 0 1 0 0 1 0 1 1 1
0 0 0 0 0 0 1 0 1 0 0 1 0 0 1 1 1 1 1 0
0 0 0 0 0 0 0 1 1 0 0 0 1 1 1 0 1 0 1 1

parity check matrix according to H = [-PT|In-k]
0 1 0 0 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0
0 1 1 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0
1 0 1 1 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0
1 1 0 1 1 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0
1 1 1 0 1 1 0 1 0 0 0 0 1 0 0 0 0 0 0 0
1 0 1 1 1 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0
0 0 0 1 0 0 1 1 0 0 0 0 0 0 1 0 0 0 0 0
1 1 0 0 0 1 1 0 0 0 0 0 0 0 0 1 0 0 0 0
1 1 1 0 0 0 1 1 0 0 0 0 0 0 0 0 1 0 0 0
0 0 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 1 0 0
1 0 0 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 1 0
0 1 1 1 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 1
*/

// parity check matrix as code
uint32_t golay_20_8_parity_check_matrix[] = {
    0b01001111100000000000,
    0b01101000010000000000,
    0b10110100001000000000,
    0b11011010000100000000,
    0b11101101000010000000,
    0b10111001000001000000,
    0b00010011000000100000,
    0b11000110000000010000,
    0b11100011000000001000,
    0b00111110000000000100,
    0b10011111000000000010,
    0b01110101000000000001
};

struct correction {
    uint32_t syndrome;
    uint32_t error_pattern;
};

// generated by applying possible combinations of errors
static struct correction corrections[] = {
    { 1, 1 },
    { 2, 2 },
    { 3, 3 },
    { 4, 4 },
    { 5, 5 },
    { 6, 6 },
    { 7, 7 },
    { 8, 8 },
    { 9, 9 },
    { 10, 10 },
    { 11, 11 },
    { 12, 12 },
    { 13, 13 },
    { 14, 14 },
    { 16, 16 },
    { 17, 17 },
    { 18, 18 },
    { 19, 19 },
    { 20, 20 },
    { 21, 21 },
    { 22, 22 },
    { 24, 24 },
    { 25, 25 },
    { 26, 26 },
    { 28, 28 },
    { 32, 32 },
    { 33, 33 },
    { 34, 34 },
    { 35, 35 },
    { 36, 36 },
    { 37, 37 },
    { 38, 38 },
    { 40, 40 },
    { 41, 41 },
    { 42, 42 },
    { 44, 44 },
    { 48, 48 },
    { 49, 49 },
    { 50, 50 },
    { 52, 52 },
    { 56, 56 },
    { 64, 64 },
    { 65, 65 },
    { 66, 66 },
    { 67, 67 },
    { 68, 68 },
    { 69, 69 },
    { 70, 70 },
    { 72, 72 },
    { 73, 73 },
    { 74, 74 },
    { 76, 76 },
    { 80, 80 },
    { 81, 81 },
    { 82, 82 },
    { 84, 84 },
    { 88, 88 },
    { 96, 96 },
    { 97, 97 },
    { 98, 98 },
    { 100, 100 },
    { 104, 104 },
    { 112, 112 },
    { 128, 128 },
    { 129, 129 },
    { 130, 130 },
    { 131, 131 },
    { 132, 132 },
    { 133, 133 },
    { 134, 134 },
    { 136, 136 },
    { 137, 137 },
    { 138, 138 },
    { 140, 140 },
    { 144, 144 },
    { 145, 145 },
    { 146, 146 },
    { 148, 148 },
    { 152, 152 },
    { 160, 160 },
    { 161, 161 },
    { 162, 162 },
    { 164, 164 },
    { 168, 168 },
    { 176, 176 },
    { 192, 192 },
    { 193, 193 },
    { 194, 194 },
    { 196, 196 },
    { 200, 200 },
    { 208, 208 },
    { 224, 224 },
    { 256, 256 },
    { 257, 257 },
    { 258, 258 },
    { 259, 259 },
    { 260, 260 },
    { 261, 261 },
    { 262, 262 },
    { 264, 264 },
    { 265, 265 },
    { 266, 266 },
    { 268, 268 },
    { 272, 272 },
    { 273, 273 },
    { 274, 274 },
    { 276, 276 },
    { 280, 280 },
    { 288, 288 },
    { 289, 289 },
    { 290, 290 },
    { 292, 292 },
    { 296, 296 },
    { 304, 304 },
    { 320, 320 },
    { 321, 321 },
    { 322, 322 },
    { 324, 324 },
    { 328, 328 },
    { 336, 336 },
    { 352, 352 },
    { 384, 384 },
    { 385, 385 },
    { 386, 386 },
    { 388, 388 },
    { 392, 392 },
    { 400, 400 },
    { 416, 416 },
    { 448, 448 },
    { 512, 512 },
    { 513, 513 },
    { 514, 514 },
    { 515, 515 },
    { 516, 516 },
    { 517, 517 },
    { 518, 518 },
    { 520, 520 },
    { 521, 521 },
    { 522, 522 },
    { 524, 524 },
    { 528, 528 },
    { 529, 529 },
    { 530, 530 },
    { 532, 532 },
    { 536, 536 },
    { 544, 544 },
    { 545, 545 },
    { 546, 546 },
    { 548, 548 },
    { 552, 552 },
    { 560, 560 },
    { 576, 576 },
    { 577, 577 },
    { 578, 578 },
    { 580, 580 },
    { 584, 584 },
    { 592, 592 },
    { 608, 608 },
    { 640, 640 },
    { 641, 641 },
    { 642, 642 },
    { 644, 644 },
    { 648, 648 },
    { 656, 656 },
    { 672, 672 },
    { 704, 704 },
    { 768, 768 },
    { 769, 769 },
    { 770, 770 },
    { 772, 772 },
    { 776, 776 },
    { 784, 784 },
    { 800, 800 },
    { 832, 832 },
    { 896, 896 },
    { 1024, 1024 },
    { 1025, 1025 },
    { 1026, 1026 },
    { 1027, 1027 },
    { 1028, 1028 },
    { 1029, 1029 },
    { 1030, 1030 },
    { 1032, 1032 },
    { 1033, 1033 },
    { 1034, 1034 },
    { 1036, 1036 },
    { 1040, 1040 },
    { 1041, 1041 },
    { 1042, 1042 },
    { 1044, 1044 },
    { 1048, 1048 },
    { 1056, 1056 },
    { 1057, 1057 },
    { 1058, 1058 },
    { 1060, 1060 },
    { 1064, 1064 },
    { 1072, 1072 },
    { 1088, 1088 },
    { 1089, 1089 },
    { 1090, 1090 },
    { 1092, 1092 },
    { 1096, 1096 },
    { 1104, 1104 },
    { 1120, 1120 },
    { 1152, 1152 },
    { 1153, 1153 },
    { 1154, 1154 },
    { 1156, 1156 },
    { 1160, 1160 },
    { 1168, 1168 },
    { 1184, 1184 },
    { 1216, 1216 },
    { 1280, 1280 },
    { 1281, 1281 },
    { 1282, 1282 },
    { 1284, 1284 },
    { 1288, 1288 },
    { 1296, 1296 },
    { 1312, 1312 },
    { 1344, 1344 },
    { 1408, 1408 },
    { 1536, 1536 },
    { 1537, 1537 },
    { 1538, 1538 },
    { 1540, 1540 },
    { 1544, 1544 },
    { 1552, 1552 },
    { 1568, 1568 },
    { 1600, 1600 },
    { 1664, 1664 },
    { 1792, 1792 },
    { 2048, 2048 },
    { 2049, 2049 },
    { 2050, 2050 },
    { 2051, 2051 },
    { 2052, 2052 },
    { 2053, 2053 },
    { 2054, 2054 },
    { 2056, 2056 },
    { 2057, 2057 },
    { 2058, 2058 },
    { 2060, 2060 },
    { 2064, 2064 },
    { 2065, 2065 },
    { 2066, 2066 },
    { 2068, 2068 },
    { 2072, 2072 },
    { 2080, 2080 },
    { 2081, 2081 },
    { 2082, 2082 },
    { 2084, 2084 },
    { 2088, 2088 },
    { 2096, 2096 },
    { 2112, 2112 },
    { 2113, 2113 },
    { 2114, 2114 },
    { 2116, 2116 },
    { 2120, 2120 },
    { 2128, 2128 },
    { 2144, 2144 },
    { 2176, 2176 },
    { 2177, 2177 },
    { 2178, 2178 },
    { 2180, 2180 },
    { 2184, 2184 },
    { 2192, 2192 },
    { 2208, 2208 },
    { 2240, 2240 },
    { 2304, 2304 },
    { 2305, 2305 },
    { 2306, 2306 },
    { 2308, 2308 },
    { 2312, 2312 },
    { 2320, 2320 },
    { 2336, 2336 },
    { 2368, 2368 },
    { 2432, 2432 },
    { 2560, 2560 },
    { 2561, 2561 },
    { 2562, 2562 },
    { 2564, 2564 },
    { 2568, 2568 },
    { 2576, 2576 },
    { 2592, 2592 },
    { 2624, 2624 },
    { 2688, 2688 },
    { 2816, 2816 },
    { 3072, 3072 },
    { 3073, 3073 },
    { 3074, 3074 },
    { 3076, 3076 },
    { 3080, 3080 },
    { 3088, 3088 },
    { 3104, 3104 },
    { 3136, 3136 },
    { 3200, 3200 },
    { 3328, 3328 },
    { 3584, 3584 },
    { 2283, 4096 },
    { 2282, 4097 },
    { 2281, 4098 },
    { 2280, 4099 },
    { 2287, 4100 },
    { 2286, 4101 },
    { 2285, 4102 },
    { 2275, 4104 },
    { 2274, 4105 },
    { 2273, 4106 },
    { 2279, 4108 },
    { 2299, 4112 },
    { 2298, 4113 },
    { 2297, 4114 },
    { 2303, 4116 },
    { 2291, 4120 },
    { 2251, 4128 },
    { 2250, 4129 },
    { 2249, 4130 },
    { 2255, 4132 },
    { 2243, 4136 },
    { 2267, 4144 },
    { 2219, 4160 },
    { 2218, 4161 },
    { 2217, 4162 },
    { 2223, 4164 },
    { 2211, 4168 },
    { 2235, 4176 },
    { 2187, 4192 },
    { 2155, 4224 },
    { 2154, 4225 },
    { 2153, 4226 },
    { 2159, 4228 },
    { 2147, 4232 },
    { 2171, 4240 },
    { 2123, 4256 },
    { 2091, 4288 },
    { 2539, 4352 },
    { 2538, 4353 },
    { 2537, 4354 },
    { 2543, 4356 },
    { 2531, 4360 },
    { 2555, 4368 },
    { 2507, 4384 },
    { 2475, 4416 },
    { 2411, 4480 },
    { 2795, 4608 },
    { 2794, 4609 },
    { 2793, 4610 },
    { 2799, 4612 },
    { 2787, 4616 },
    { 2811, 4624 },
    { 2763, 4640 },
    { 2731, 4672 },
    { 2667, 4736 },
    { 3051, 4864 },
    { 3307, 5120 },
    { 3306, 5121 },
    { 3305, 5122 },
    { 3311, 5124 },
    { 3299, 5128 },
    { 3323, 5136 },
    { 3275, 5152 },
    { 3243, 5184 },
    { 3179, 5248 },
    { 3563, 5376 },
    { 3819, 5632 },
    { 235, 6144 },
    { 234, 6145 },
    { 233, 6146 },
    { 239, 6148 },
    { 227, 6152 },
    { 251, 6160 },
    { 203, 6176 },
    { 171, 6208 },
    { 107, 6272 },
    { 491, 6400 },
    { 747, 6656 },
    { 1259, 7168 },
    { 2366, 8192 },
    { 2367, 8193 },
    { 2364, 8194 },
    { 2365, 8195 },
    { 2362, 8196 },
    { 2363, 8197 },
    { 2360, 8198 },
    { 2358, 8200 },
    { 2359, 8201 },
    { 2356, 8202 },
    { 2354, 8204 },
    { 2350, 8208 },
    { 2351, 8209 },
    { 2348, 8210 },
    { 2346, 8212 },
    { 2342, 8216 },
    { 2334, 8224 },
    { 2335, 8225 },
    { 2332, 8226 },
    { 2330, 8228 },
    { 2326, 8232 },
    { 2318, 8240 },
    { 2430, 8256 },
    { 2431, 8257 },
    { 2428, 8258 },
    { 2426, 8260 },
    { 2422, 8264 },
    { 2414, 8272 },
    { 2398, 8288 },
    { 2494, 8320 },
    { 2495, 8321 },
    { 2492, 8322 },
    { 2490, 8324 },
    { 2486, 8328 },
    { 2478, 8336 },
    { 2462, 8352 },
    { 2558, 8384 },
    { 2110, 8448 },
    { 2111, 8449 },
    { 2108, 8450 },
    { 2106, 8452 },
    { 2102, 8456 },
    { 2094, 8464 },
    { 2078, 8480 },
    { 2174, 8512 },
    { 2238, 8576 },
    { 2878, 8704 },
    { 2879, 8705 },
    { 2876, 8706 },
    { 2874, 8708 },
    { 2870, 8712 },
    { 2862, 8720 },
    { 2846, 8736 },
    { 2942, 8768 },
    { 3006, 8832 },
    { 2622, 8960 },
    { 3390, 9216 },
    { 3391, 9217 },
    { 3388, 9218 },
    { 3386, 9220 },
    { 3382, 9224 },
    { 3374, 9232 },
    { 3358, 9248 },
    { 3454, 9280 },
    { 3518, 9344 },
    { 3134, 9472 },
    { 3902, 9728 },
    { 318, 10240 },
    { 319, 10241 },
    { 316, 10242 },
    { 314, 10244 },
    { 310, 10248 },
    { 302, 10256 },
    { 286, 10272 },
    { 382, 10304 },
    { 446, 10368 },
    { 62, 10496 },
    { 830, 10752 },
    { 1342, 11264 },
    { 469, 12288 },
    { 468, 12289 },
    { 471, 12290 },
    { 465, 12292 },
    { 477, 12296 },
    { 453, 12304 },
    { 501, 12320 },
    { 405, 12352 },
    { 341, 12416 },
    { 213, 12544 },
    { 981, 12800 },
    { 1493, 13312 },
    { 2517, 14336 },
    { 2711, 16384 },
    { 2710, 16385 },
    { 2709, 16386 },
    { 2708, 16387 },
    { 2707, 16388 },
    { 2706, 16389 },
    { 2705, 16390 },
    { 2719, 16392 },
    { 2718, 16393 },
    { 2717, 16394 },
    { 2715, 16396 },
    { 2695, 16400 },
    { 2694, 16401 },
    { 2693, 16402 },
    { 2691, 16404 },
    { 2703, 16408 },
    { 2743, 16416 },
    { 2742, 16417 },
    { 2741, 16418 },
    { 2739, 16420 },
    { 2751, 16424 },
    { 2727, 16432 },
    { 2775, 16448 },
    { 2774, 16449 },
    { 2773, 16450 },
    { 2771, 16452 },
    { 2783, 16456 },
    { 2759, 16464 },
    { 2807, 16480 },
    { 2583, 16512 },
    { 2582, 16513 },
    { 2581, 16514 },
    { 2579, 16516 },
    { 2591, 16520 },
    { 2567, 16528 },
    { 2615, 16544 },
    { 2647, 16576 },
    { 2967, 16640 },
    { 2966, 16641 },
    { 2965, 16642 },
    { 2963, 16644 },
    { 2975, 16648 },
    { 2951, 16656 },
    { 2999, 16672 },
    { 3031, 16704 },
    { 2839, 16768 },
    { 2199, 16896 },
    { 2198, 16897 },
    { 2197, 16898 },
    { 2195, 16900 },
    { 2207, 16904 },
    { 2183, 16912 },
    { 2231, 16928 },
    { 2263, 16960 },
    { 2071, 17024 },
    { 2455, 17152 },
    { 3735, 17408 },
    { 3734, 17409 },
    { 3733, 17410 },
    { 3731, 17412 },
    { 3743, 17416 },
    { 3719, 17424 },
    { 3767, 17440 },
    { 3799, 17472 },
    { 3607, 17536 },
    { 3991, 17664 },
    { 3223, 17920 },
    { 663, 18432 },
    { 662, 18433 },
    { 661, 18434 },
    { 659, 18436 },
    { 671, 18440 },
    { 647, 18448 },
    { 695, 18464 },
    { 727, 18496 },
    { 535, 18560 },
    { 919, 18688 },
    { 151, 18944 },
    { 1687, 19456 },
    { 636, 20480 },
    { 637, 20481 },
    { 638, 20482 },
    { 632, 20484 },
    { 628, 20488 },
    { 620, 20496 },
    { 604, 20512 },
    { 572, 20544 },
    { 764, 20608 },
    { 892, 20736 },
    { 124, 20992 },
    { 1660, 21504 },
    { 2684, 22528 },
    { 937, 24576 },
    { 936, 24577 },
    { 939, 24578 },
    { 941, 24580 },
    { 929, 24584 },
    { 953, 24592 },
    { 905, 24608 },
    { 1001, 24640 },
    { 809, 24704 },
    { 681, 24832 },
    { 425, 25088 },
    { 1961, 25600 },
    { 2985, 26624 },
    { 2882, 28672 },
    { 3526, 32768 },
    { 3527, 32769 },
    { 3524, 32770 },
    { 3525, 32771 },
    { 3522, 32772 },
    { 3523, 32773 },
    { 3520, 32774 },
    { 3534, 32776 },
    { 3535, 32777 },
    { 3532, 32778 },
    { 3530, 32780 },
    { 3542, 32784 },
    { 3543, 32785 },
    { 3540, 32786 },
    { 3538, 32788 },
    { 3550, 32792 },
    { 3558, 32800 },
    { 3559, 32801 },
    { 3556, 32802 },
    { 3554, 32804 },
    { 3566, 32808 },
    { 3574, 32816 },
    { 3462, 32832 },
    { 3463, 32833 },
    { 3460, 32834 },
    { 3458, 32836 },
    { 3470, 32840 },
    { 3478, 32848 },
    { 3494, 32864 },
    { 3398, 32896 },
    { 3399, 32897 },
    { 3396, 32898 },
    { 3394, 32900 },
    { 3406, 32904 },
    { 3414, 32912 },
    { 3430, 32928 },
    { 3334, 32960 },
    { 3270, 33024 },
    { 3271, 33025 },
    { 3268, 33026 },
    { 3266, 33028 },
    { 3278, 33032 },
    { 3286, 33040 },
    { 3302, 33056 },
    { 3206, 33088 },
    { 3142, 33152 },
    { 4038, 33280 },
    { 4039, 33281 },
    { 4036, 33282 },
    { 4034, 33284 },
    { 4046, 33288 },
    { 4054, 33296 },
    { 4070, 33312 },
    { 3974, 33344 },
    { 3910, 33408 },
    { 3782, 33536 },
    { 2502, 33792 },
    { 2503, 33793 },
    { 2500, 33794 },
    { 2498, 33796 },
    { 2510, 33800 },
    { 2518, 33808 },
    { 2534, 33824 },
    { 2438, 33856 },
    { 2374, 33920 },
    { 2246, 34048 },
    { 3014, 34304 },
    { 1478, 34816 },
    { 1479, 34817 },
    { 1476, 34818 },
    { 1474, 34820 },
    { 1486, 34824 },
    { 1494, 34832 },
    { 1510, 34848 },
    { 1414, 34880 },
    { 1350, 34944 },
    { 1222, 35072 },
    { 1990, 35328 },
    { 454, 35840 },
    { 1325, 36864 },
    { 1324, 36865 },
    { 1327, 36866 },
    { 1321, 36868 },
    { 1317, 36872 },
    { 1341, 36880 },
    { 1293, 36896 },
    { 1389, 36928 },
    { 1453, 36992 },
    { 1069, 37120 },
    { 1837, 37376 },
    { 301, 37888 },
    { 3373, 38912 },
    { 1272, 40960 },
    { 1273, 40961 },
    { 1274, 40962 },
    { 1276, 40964 },
    { 1264, 40968 },
    { 1256, 40976 },
    { 1240, 40992 },
    { 1208, 41024 },
    { 1144, 41088 },
    { 1528, 41216 },
    { 1784, 41472 },
    { 248, 41984 },
    { 3320, 43008 },
    { 3091, 45056 },
    { 1873, 49152 },
    { 1872, 49153 },
    { 1875, 49154 },
    { 1877, 49156 },
    { 1881, 49160 },
    { 1857, 49168 },
    { 1905, 49184 },
    { 1809, 49216 },
    { 2001, 49280 },
    { 1617, 49408 },
    { 1361, 49664 },
    { 849, 50176 },
    { 3921, 51200 },
    { 4026, 53248 },
    { 3695, 57344 },
    { 871, 65536 },
    { 870, 65537 },
    { 869, 65538 },
    { 868, 65539 },
    { 867, 65540 },
    { 866, 65541 },
    { 865, 65542 },
    { 879, 65544 },
    { 878, 65545 },
    { 877, 65546 },
    { 875, 65548 },
    { 887, 65552 },
    { 886, 65553 },
    { 885, 65554 },
    { 883, 65556 },
    { 895, 65560 },
    { 839, 65568 },
    { 838, 65569 },
    { 837, 65570 },
    { 835, 65572 },
    { 847, 65576 },
    { 855, 65584 },
    { 807, 65600 },
    { 806, 65601 },
    { 805, 65602 },
    { 803, 65604 },
    { 815, 65608 },
    { 823, 65616 },
    { 775, 65632 },
    { 999, 65664 },
    { 998, 65665 },
    { 997, 65666 },
    { 995, 65668 },
    { 1007, 65672 },
    { 1015, 65680 },
    { 967, 65696 },
    { 935, 65728 },
    { 615, 65792 },
    { 614, 65793 },
    { 613, 65794 },
    { 611, 65796 },
    { 623, 65800 },
    { 631, 65808 },
    { 583, 65824 },
    { 551, 65856 },
    { 743, 65920 },
    { 359, 66048 },
    { 358, 66049 },
    { 357, 66050 },
    { 355, 66052 },
    { 367, 66056 },
    { 375, 66064 },
    { 327, 66080 },
    { 295, 66112 },
    { 487, 66176 },
    { 103, 66304 },
    { 1895, 66560 },
    { 1894, 66561 },
    { 1893, 66562 },
    { 1891, 66564 },
    { 1903, 66568 },
    { 1911, 66576 },
    { 1863, 66592 },
    { 1831, 66624 },
    { 2023, 66688 },
    { 1639, 66816 },
    { 1383, 67072 },
    { 2919, 67584 },
    { 2918, 67585 },
    { 2917, 67586 },
    { 2915, 67588 },
    { 2927, 67592 },
    { 2935, 67600 },
    { 2887, 67616 },
    { 2855, 67648 },
    { 3047, 67712 },
    { 2663, 67840 },
    { 2407, 68096 },
    { 3943, 68608 },
    { 2956, 69632 },
    { 2957, 69633 },
    { 2958, 69634 },
    { 2952, 69636 },
    { 2948, 69640 },
    { 2972, 69648 },
    { 2988, 69664 },
    { 3020, 69696 },
    { 2828, 69760 },
    { 2700, 69888 },
    { 2444, 70144 },
    { 3980, 70656 },
    { 908, 71680 },
    { 2649, 73728 },
    { 2648, 73729 },
    { 2651, 73730 },
    { 2653, 73732 },
    { 2641, 73736 },
    { 2633, 73744 },
    { 2681, 73760 },
    { 2585, 73792 },
    { 2777, 73856 },
    { 2905, 73984 },
    { 2137, 74240 },
    { 3673, 74752 },
    { 601, 75776 },
    { 690, 77824 },
    { 2544, 81920 },
    { 2545, 81921 },
    { 2546, 81922 },
    { 2548, 81924 },
    { 2552, 81928 },
    { 2528, 81936 },
    { 2512, 81952 },
    { 2480, 81984 },
    { 2416, 82048 },
    { 2288, 82176 },
    { 3056, 82432 },
    { 3568, 82944 },
    { 496, 83968 },
    { 283, 86016 },
    { 206, 90112 },
    { 3745, 98304 },
    { 3744, 98305 },
    { 3747, 98306 },
    { 3749, 98308 },
    { 3753, 98312 },
    { 3761, 98320 },
    { 3713, 98336 },
    { 3809, 98368 },
    { 3617, 98432 },
    { 4001, 98560 },
    { 3233, 98816 },
    { 2721, 99328 },
    { 1697, 100352 },
    { 1610, 102400 },
    { 1951, 106496 },
    { 1078, 114688 },
    { 1741, 131072 },
    { 1740, 131073 },
    { 1743, 131074 },
    { 1742, 131075 },
    { 1737, 131076 },
    { 1736, 131077 },
    { 1739, 131078 },
    { 1733, 131080 },
    { 1732, 131081 },
    { 1735, 131082 },
    { 1729, 131084 },
    { 1757, 131088 },
    { 1756, 131089 },
    { 1759, 131090 },
    { 1753, 131092 },
    { 1749, 131096 },
    { 1773, 131104 },
    { 1772, 131105 },
    { 1775, 131106 },
    { 1769, 131108 },
    { 1765, 131112 },
    { 1789, 131120 },
    { 1677, 131136 },
    { 1676, 131137 },
    { 1679, 131138 },
    { 1673, 131140 },
    { 1669, 131144 },
    { 1693, 131152 },
    { 1709, 131168 },
    { 1613, 131200 },
    { 1612, 131201 },
    { 1615, 131202 },
    { 1609, 131204 },
    { 1605, 131208 },
    { 1629, 131216 },
    { 1645, 131232 },
    { 1549, 131264 },
    { 1997, 131328 },
    { 1996, 131329 },
    { 1999, 131330 },
    { 1993, 131332 },
    { 1989, 131336 },
    { 2013, 131344 },
    { 2029, 131360 },
    { 1933, 131392 },
    { 1869, 131456 },
    { 1229, 131584 },
    { 1228, 131585 },
    { 1231, 131586 },
    { 1225, 131588 },
    { 1221, 131592 },
    { 1245, 131600 },
    { 1261, 131616 },
    { 1165, 131648 },
    { 1101, 131712 },
    { 1485, 131840 },
    { 717, 132096 },
    { 716, 132097 },
    { 719, 132098 },
    { 713, 132100 },
    { 709, 132104 },
    { 733, 132112 },
    { 749, 132128 },
    { 653, 132160 },
    { 589, 132224 },
    { 973, 132352 },
    { 205, 132608 },
    { 3789, 133120 },
    { 3788, 133121 },
    { 3791, 133122 },
    { 3785, 133124 },
    { 3781, 133128 },
    { 3805, 133136 },
    { 3821, 133152 },
    { 3725, 133184 },
    { 3661, 133248 },
    { 4045, 133376 },
    { 3277, 133632 },
    { 2765, 134144 },
    { 3622, 135168 },
    { 3623, 135169 },
    { 3620, 135170 },
    { 3618, 135172 },
    { 3630, 135176 },
    { 3638, 135184 },
    { 3590, 135200 },
    { 3686, 135232 },
    { 3750, 135296 },
    { 3878, 135424 },
    { 3110, 135680 },
    { 2598, 136192 },
    { 1574, 137216 },
    { 4083, 139264 },
    { 4082, 139265 },
    { 4081, 139266 },
    { 4087, 139268 },
    { 4091, 139272 },
    { 4067, 139280 },
    { 4051, 139296 },
    { 4019, 139328 },
    { 3955, 139392 },
    { 3827, 139520 },
    { 3571, 139776 },
    { 3059, 140288 },
    { 2035, 141312 },
    { 1816, 143360 },
    { 3162, 147456 },
    { 3163, 147457 },
    { 3160, 147458 },
    { 3166, 147460 },
    { 3154, 147464 },
    { 3146, 147472 },
    { 3194, 147488 },
    { 3098, 147520 },
    { 3290, 147584 },
    { 3418, 147712 },
    { 3674, 147968 },
    { 2138, 148480 },
    { 1114, 149504 },
    { 1201, 151552 },
    { 1380, 155648 },
    { 2827, 163840 },
    { 2826, 163841 },
    { 2825, 163842 },
    { 2831, 163844 },
    { 2819, 163848 },
    { 2843, 163856 },
    { 2859, 163872 },
    { 2891, 163904 },
    { 2955, 163968 },
    { 2571, 164096 },
    { 2315, 164352 },
    { 3851, 164864 },
    { 779, 165888 },
    { 992, 167936 },
    { 565, 172032 },
    { 412, 180224 },
    { 1450, 196608 },
    { 1451, 196609 },
    { 1448, 196610 },
    { 1454, 196612 },
    { 1442, 196616 },
    { 1466, 196624 },
    { 1418, 196640 },
    { 1514, 196672 },
    { 1322, 196736 },
    { 1194, 196864 },
    { 1962, 197120 },
    { 426, 197632 },
    { 3498, 198656 },
    { 3393, 200704 },
    { 3220, 204800 },
    { 3901, 212992 },
    { 2156, 229376 },
    { 3481, 262144 },
    { 3480, 262145 },
    { 3483, 262146 },
    { 3482, 262147 },
    { 3485, 262148 },
    { 3484, 262149 },
    { 3487, 262150 },
    { 3473, 262152 },
    { 3472, 262153 },
    { 3475, 262154 },
    { 3477, 262156 },
    { 3465, 262160 },
    { 3464, 262161 },
    { 3467, 262162 },
    { 3469, 262164 },
    { 3457, 262168 },
    { 3513, 262176 },
    { 3512, 262177 },
    { 3515, 262178 },
    { 3517, 262180 },
    { 3505, 262184 },
    { 3497, 262192 },
    { 3545, 262208 },
    { 3544, 262209 },
    { 3547, 262210 },
    { 3549, 262212 },
    { 3537, 262216 },
    { 3529, 262224 },
    { 3577, 262240 },
    { 3353, 262272 },
    { 3352, 262273 },
    { 3355, 262274 },
    { 3357, 262276 },
    { 3345, 262280 },
    { 3337, 262288 },
    { 3385, 262304 },
    { 3417, 262336 },
    { 3225, 262400 },
    { 3224, 262401 },
    { 3227, 262402 },
    { 3229, 262404 },
    { 3217, 262408 },
    { 3209, 262416 },
    { 3257, 262432 },
    { 3289, 262464 },
    { 3097, 262528 },
    { 3993, 262656 },
    { 3992, 262657 },
    { 3995, 262658 },
    { 3997, 262660 },
    { 3985, 262664 },
    { 3977, 262672 },
    { 4025, 262688 },
    { 4057, 262720 },
    { 3865, 262784 },
    { 3737, 262912 },
    { 2457, 263168 },
    { 2456, 263169 },
    { 2459, 263170 },
    { 2461, 263172 },
    { 2449, 263176 },
    { 2441, 263184 },
    { 2489, 263200 },
    { 2521, 263232 },
    { 2329, 263296 },
    { 2201, 263424 },
    { 2969, 263680 },
    { 1433, 264192 },
    { 1432, 264193 },
    { 1435, 264194 },
    { 1437, 264196 },
    { 1425, 264200 },
    { 1417, 264208 },
    { 1465, 264224 },
    { 1497, 264256 },
    { 1305, 264320 },
    { 1177, 264448 },
    { 1945, 264704 },
    { 409, 265216 },
    { 1394, 266240 },
    { 1395, 266241 },
    { 1392, 266242 },
    { 1398, 266244 },
    { 1402, 266248 },
    { 1378, 266256 },
    { 1362, 266272 },
    { 1330, 266304 },
    { 1522, 266368 },
    { 1138, 266496 },
    { 1906, 266752 },
    { 370, 267264 },
    { 3442, 268288 },
    { 1191, 270336 },
    { 1190, 270337 },
    { 1189, 270338 },
    { 1187, 270340 },
    { 1199, 270344 },
    { 1207, 270352 },
    { 1159, 270368 },
    { 1255, 270400 },
    { 1063, 270464 },
    { 1447, 270592 },
    { 1703, 270848 },
    { 167, 271360 },
    { 3239, 272384 },
    { 3148, 274432 },
    { 1806, 278528 },
    { 1807, 278529 },
    { 1804, 278530 },
    { 1802, 278532 },
    { 1798, 278536 },
    { 1822, 278544 },
    { 1838, 278560 },
    { 1870, 278592 },
    { 1934, 278656 },
    { 1550, 278784 },
    { 1294, 279040 },
    { 782, 279552 },
    { 3854, 280576 },
    { 4069, 282624 },
    { 3632, 286720 },
    { 95, 294912 },
    { 94, 294913 },
    { 93, 294914 },
    { 91, 294916 },
    { 87, 294920 },
    { 79, 294928 },
    { 127, 294944 },
    { 31, 294976 },
    { 223, 295040 },
    { 351, 295168 },
    { 607, 295424 },
    { 1119, 295936 },
    { 2143, 296960 },
    { 2228, 299008 },
    { 2401, 303104 },
    { 2760, 311296 },
    { 3838, 327680 },
    { 3839, 327681 },
    { 3836, 327682 },
    { 3834, 327684 },
    { 3830, 327688 },
    { 3822, 327696 },
    { 3806, 327712 },
    { 3774, 327744 },
    { 3710, 327808 },
    { 4094, 327936 },
    { 3326, 328192 },
    { 2814, 328704 },
    { 1790, 329728 },
    { 1557, 331776 },
    { 1984, 335872 },
    { 1129, 344064 },
    { 824, 360448 },
    { 2900, 393216 },
    { 2901, 393217 },
    { 2902, 393218 },
    { 2896, 393220 },
    { 2908, 393224 },
    { 2884, 393232 },
    { 2932, 393248 },
    { 2836, 393280 },
    { 3028, 393344 },
    { 2644, 393472 },
    { 2388, 393728 },
    { 3924, 394240 },
    { 852, 395264 },
    { 959, 397312 },
    { 618, 401408 },
    { 451, 409600 },
    { 1682, 425984 },
    { 2099, 458752 },
    { 986, 524288 },
    { 987, 524289 },
    { 984, 524290 },
    { 985, 524291 },
    { 990, 524292 },
    { 991, 524293 },
    { 988, 524294 },
    { 978, 524296 },
    { 979, 524297 },
    { 976, 524298 },
    { 982, 524300 },
    { 970, 524304 },
    { 971, 524305 },
    { 968, 524306 },
    { 974, 524308 },
    { 962, 524312 },
    { 1018, 524320 },
    { 1019, 524321 },
    { 1016, 524322 },
    { 1022, 524324 },
    { 1010, 524328 },
    { 1002, 524336 },
    { 922, 524352 },
    { 923, 524353 },
    { 920, 524354 },
    { 926, 524356 },
    { 914, 524360 },
    { 906, 524368 },
    { 954, 524384 },
    { 858, 524416 },
    { 859, 524417 },
    { 856, 524418 },
    { 862, 524420 },
    { 850, 524424 },
    { 842, 524432 },
    { 890, 524448 },
    { 794, 524480 },
    { 730, 524544 },
    { 731, 524545 },
    { 728, 524546 },
    { 734, 524548 },
    { 722, 524552 },
    { 714, 524560 },
    { 762, 524576 },
    { 666, 524608 },
    { 602, 524672 },
    { 474, 524800 },
    { 475, 524801 },
    { 472, 524802 },
    { 478, 524804 },
    { 466, 524808 },
    { 458, 524816 },
    { 506, 524832 },
    { 410, 524864 },
    { 346, 524928 },
    { 218, 525056 },
    { 2010, 525312 },
    { 2011, 525313 },
    { 2008, 525314 },
    { 2014, 525316 },
    { 2002, 525320 },
    { 1994, 525328 },
    { 2042, 525344 },
    { 1946, 525376 },
    { 1882, 525440 },
    { 1754, 525568 },
    { 1498, 525824 },
    { 3034, 526336 },
    { 3035, 526337 },
    { 3032, 526338 },
    { 3038, 526340 },
    { 3026, 526344 },
    { 3018, 526352 },
    { 3066, 526368 },
    { 2970, 526400 },
    { 2906, 526464 },
    { 2778, 526592 },
    { 2522, 526848 },
    { 4058, 527360 },
    { 2865, 528384 },
    { 2864, 528385 },
    { 2867, 528386 },
    { 2869, 528388 },
    { 2873, 528392 },
    { 2849, 528400 },
    { 2833, 528416 },
    { 2929, 528448 },
    { 2993, 528512 },
    { 2609, 528640 },
    { 2353, 528896 },
    { 3889, 529408 },
    { 817, 530432 },
    { 2788, 532480 },
    { 2789, 532481 },
    { 2790, 532482 },
    { 2784, 532484 },
    { 2796, 532488 },
    { 2804, 532496 },
    { 2756, 532512 },
    { 2724, 532544 },
    { 2660, 532608 },
    { 3044, 532736 },
    { 2276, 532992 },
    { 3812, 533504 },
    { 740, 534528 },
    { 527, 536576 },
    { 2381, 540672 },
    { 2380, 540673 },
    { 2383, 540674 },
    { 2377, 540676 },
    { 2373, 540680 },
    { 2397, 540688 },
    { 2413, 540704 },
    { 2317, 540736 },
    { 2509, 540800 },
    { 2125, 540928 },
    { 2893, 541184 },
    { 3405, 541696 },
    { 333, 542720 },
    { 422, 544768 },
    { 115, 548864 },
    { 3612, 557056 },
    { 3613, 557057 },
    { 3614, 557058 },
    { 3608, 557060 },
    { 3604, 557064 },
    { 3596, 557072 },
    { 3644, 557088 },
    { 3676, 557120 },
    { 3740, 557184 },
    { 3868, 557312 },
    { 3100, 557568 },
    { 2588, 558080 },
    { 1564, 559104 },
    { 1783, 561152 },
    { 1826, 565248 },
    { 1163, 573440 },
    { 189, 589824 },
    { 188, 589825 },
    { 191, 589826 },
    { 185, 589828 },
    { 181, 589832 },
    { 173, 589840 },
    { 157, 589856 },
    { 253, 589888 },
    { 61, 589952 },
    { 445, 590080 },
    { 701, 590336 },
    { 1213, 590848 },
    { 2237, 591872 },
    { 2134, 593920 },
    { 2435, 598016 },
    { 2602, 606208 },
    { 3451, 622592 },
    { 1303, 655360 },
    { 1302, 655361 },
    { 1301, 655362 },
    { 1299, 655364 },
    { 1311, 655368 },
    { 1287, 655376 },
    { 1335, 655392 },
    { 1367, 655424 },
    { 1431, 655488 },
    { 1047, 655616 },
    { 1815, 655872 },
    { 279, 656384 },
    { 3351, 657408 },
    { 3580, 659456 },
    { 3113, 663552 },
    { 3968, 671744 },
    { 2257, 688128 },
    { 1648, 720896 },
    { 3651, 786432 },
    { 3650, 786433 },
    { 3649, 786434 },
    { 3655, 786436 },
    { 3659, 786440 },
    { 3667, 786448 },
    { 3683, 786464 },
    { 3587, 786496 },
    { 3779, 786560 },
    { 3907, 786688 },
    { 3139, 786944 },
    { 2627, 787456 },
    { 1603, 788480 },
    { 1704, 790528 },
    { 1917, 794624 },
    { 1236, 802816 },
    { 901, 819200 },
    { 3364, 851968 },
    { 2190, 917504 }
};

uint32_t golay_20_8_parity(uint32_t* data) {
    uint32_t parity = 0;

    uint8_t k;
    for (k = 0; k < 12; k++) {
        uint8_t bit = 0, l;
        for (l = 0; l < 20; l++) {
            if ((golay_20_8_parity_check_matrix[k] >> l) & 1) {
                bit ^= ((*data >> l) & 1);
            }
        }

        parity = (parity << 1) | (bit & 1);
    }

    return parity;
}

bool golay_20_8(uint32_t* data) {
    uint32_t parity = golay_20_8_parity(data);

    if (parity == 0) return true;

    int num_corrections = sizeof(corrections)/sizeof(corrections[0]);
    for (int i = 0; i < num_corrections; i++) {
        if (corrections[i].syndrome == parity) {
            *data = *data ^ corrections[i].error_pattern;
            return true;
        }
    }

    return false;
}
